!function(t){t.fn.date=function(){return this.each(function(){if(t(this).data("pikaday"))return t(this);var e=t(this).attr("type","text"),a=e.next(),r=e.data("format"),n=e.val(),i=n?moment(n).format(r):null;if(e.attr("placeholder",r),e.val(i),e.is("[readonly]"))return!1;e.on("change",function(){var t=e.val();t?a.val(moment(t,r).format("YYYY-MM-DD")):a.val("")});var o=new Pikaday({field:this,firstDay:1,format:r,i18n:e.data("i18n"),onSelect:function(t){a.val(moment(t).format("YYYY-MM-DD"))}});t(this).data("pikaday",o)})}}(jQuery),function(t){var e=function(e){var a=t(e),r=a.data("style"),n=a.data("api"),i=a.data("sortable"),o="table"==r?a.find(".structure-table tbody"):a.find(".structure-entries");return i===!1?!1:void o.sortable({helper:function(e,a){return a.children().each(function(){t(this).width(t(this).width())}),a.addClass("structure-sortable-helper")},update:function(){var e=[];t.each(t(this).sortable("toArray"),function(t,a){e.push(a.replace("structure-entry-",""))}),t.post(n,{ids:e},function(){app.content.reload()})}})};t.fn.structure=function(){return this.each(function(){if(t(this).data("structure"))return t(this);var a=new e(this);return t(this).data("structure",a),t(this)})}}(jQuery),function(t){t.fn.counter=function(){return this.each(function(){var e=t(this);if(e.data("counter"))return e;var a=e.parent(".field").find(".input"),r=t.trim(a.val()).length,n=a.data("max"),i=a.data("min");a.keyup(function(){r=t.trim(a.val()).length,e.text(r+(n?"/"+n:"")),n&&r>n||i&&i>r?e.addClass("outside-range"):e.removeClass("outside-range")}).trigger("keyup"),e.data("counter",!0)})}}(jQuery),function(t){t.fn.editor=function(){return this.each(function(){if(t(this).data("editor"))return t(this);var e=t(this),a=e.parent().find(".field-buttons");e.autosize(),a.find(".btn").on("click.editorButton",function(a){e.focus();var r=t(this);if(r.data("action"))app.modal.open(r.data("action"),window.location.href);else{var n=e.getSelection(),i=r.data("tpl"),o=r.data("text");n.length>0&&(o=n);var u=i.replace("{text}",o);e.insertAtCursor(u),e.trigger("autosize.resize")}return!1}),a.find("[data-editor-shortcut]").each(function(a,r){var n=t(this).data("editor-shortcut"),i=function(e){return t(r).trigger("click"),!1};e.bind("keydown",n,i),n.match(/meta\+/)&&e.bind("keydown",n.replace("meta+","ctrl+"),i)}),e.data("tabs")!==!1&&e.bind("keydown",function(t){if(9===t.keyCode){for(var a="";a.length<e.data("tabs");)a+=" ";if(t.shiftKey){var r=e.caret(),n=e.val();return n.substring(r-e.data("tabs"),r)===a&&(n=n.substring(0,r-e.data("tabs"))+n.substring(r),e.val(n)),!1}return t.altKey?!0:(e.insertAtCursor(a),!1)}}),e.data("editor",!0)})},t.fn.caret=function(){var t=this[0];if(t){if(window.getSelection)return t.selectionStart;if(document.selection){t.focus();var e=0,a=t.createTextRange(),r=document.selection.createRange().duplicate(),n=r.getBookmark();for(a.moveToBookmark(n);0!==a.moveStart("character",-1);)e++;return e}if(t.selectionStart)return t.selectionStart}}}(jQuery);